<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bettara.com - Dynamic Showcase</title>
    <!-- Load Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Lucide Icons for Navigation --><script src="https://unpkg.com/lucide@latest"></script>
    <!-- Configure Tailwind for Dark Mode and Custom Colors --><script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // NEW USER PALETTE MAPPING FOR LIGHT THEME
                        'light-bg': '#eeeeee',      // Primary Background (Very Light Grey)
                        'dark-text': '#222222',     // New main text color for contrast
                        
                        // New Primary Accent (Teal)
                        'primary-accent': '#71a0a5', 
                        
                        // Supportive colors
                        'hover-dark': '#333333',    // Used for button hover text
                        'secondary-text': '#999999',// Subtle lines/placeholders
                        
                        // Venture Colors
                        'venture-1': '#acc6aa',       // Light Sage Green (Present, pas presse)
                        'venture-2': '#71a0a5',       // Desaturated Teal (Passerelles)
                        'venture-3': '#77628c',       // Desaturated Purple (Facettes)
                        'venture-4': '#77628c',       // Desaturated Purple (About Me)
                        'venture-5': '#acc6aa',       // Light Sage Green (Contact)
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                },
            }
        }
    </script>
    <style>
        /* Custom styles for EA-like aesthetic, performance, and scroll */
        body {
            scroll-snap-type: y mandatory;
            overflow-x: hidden;
            background-color: #eeeeee; /* Updated to new light background */
            color: #222222; /* Updated default text color to dark */
            transition: background-color 0.5s;
        }
        .snap-section {
            height: 100vh;
            scroll-snap-align: start;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 10;
            padding-top: 5rem; /* Space for the fixed header */
            padding-bottom: 4rem; 
            padding-left: 1rem;
            padding-right: 1rem;
            opacity: 0;
            transition: opacity 0.5s;
        }
        .snap-section.active {
            opacity: 1;
        }
        
        /* Content Animation on Section Activation */
        .content-container {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
            transition-delay: 0.2s; 
            width: 100%; 
            max-width: 1280px; 
        }

        .content-container img {
            max-width: 100%;
            height: 100%;
        }

        .snap-section.active .content-container {
            opacity: 1;
            transform: translateY(0);
        }

        .hero-text {
            /* Fluid typography for bold, responsive headlines */
            font-size: clamp(2.5rem, 10vw, 8rem); 
            line-height: 1;
            letter-spacing: -0.05em;
            font-weight: 900;
        }
        
        /* Ghost Button Style */
        .link-button {
            transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s, color 0.3s, border-color 0.3s;
            transform: translateY(0);
            outline: none;
            box-shadow: 0 0 0 2px var(--tw-ring-color), 0 0 0 4px var(--tw-ring-offset-color);
        }
        .link-button:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 10px 20px -5px var(--hover-shadow-color);
        }
        
        /* Canvas is static background */
        .canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none; 
        }

        /* Fixed Navigation Header (Updated for Light Mode) */
        .header-fixed {
            backdrop-filter: blur(8px);
            background-color: rgba(255, 255, 255, 0.7); /* Light transparent background */
        }
        
        /* Mobile Menu Drawer Styling */
        #mobile-menu {
            transition: transform 0.3s ease-out;
            transform: translateX(100%); /* Start off-screen */
        }
        #mobile-menu.open {
            transform: translateX(0); /* Slide in */
        }

        /* Language toggle animation */
        #langToggle, #mobileLangToggle {
            position: relative;
            overflow: hidden;
        }
        
        #langToggle::after, #mobileLangToggle::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s;
        }
        
        #langToggle:active::after, #mobileLangToggle:active::after {
            width: 100px;
            height: 100px;
        }

        /* Responsive adjustments for mobile */
        @media (max-width: 640px) {
            .hero-text {
                font-size: clamp(2rem, 15vw, 4rem);
            }
            .link-button {
                font-size: 0.875rem; 
            }
        }
    </style>
</head>
<body class="font-sans">

    <!-- FIXED HEADER / NAVIGATION BAR (Updated for Light Theme) -->
    <header class="fixed top-0 left-0 w-full z-50 header-fixed shadow-lg">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center h-16">
            <div class="text-2xl font-black text-dark-text tracking-widest">
                BETTARA
            </div>
            <!-- Desktop Menu -->
            <div class="hidden md:flex space-x-6 items-center">
                <!-- Navigation Links -->
                <a href="#present" class="nav-link text-sm font-medium text-secondary-text hover:text-dark-text transition duration-200">Present</a>
                <a href="#passerelles" class="nav-link text-sm font-medium text-secondary-text hover:text-dark-text transition duration-200">Passerelles</a>
                <a href="#facettes" class="nav-link text-sm font-medium text-secondary-text hover:text-dark-text transition duration-200">Facettes</a>
                <a href="#about" class="nav-link text-sm font-medium text-secondary-text hover:text-dark-text transition duration-200">About</a>
                
                <!-- CTA Button -->
                <a href="#contact" class="nav-link text-sm font-bold bg-primary-accent px-4 py-1 rounded-full text-white hover:bg-hover-dark transition duration-200" data-content="contact.cta">Contact</a>
                
                <!-- Single Language Toggle Button -->
                <button id="langToggle" class="text-sm font-bold px-4 py-2 rounded-full transition duration-200 bg-primary-accent text-white hover:bg-hover-dark ml-4">
                    EN
                </button>
            </div>
            
            <!-- Mobile Menu Toggler (Hamburger) -->
            <button id="menu-toggler" class="md:hidden text-dark-text p-2" aria-label="Open Menu">
                <i data-lucide="menu" class="w-6 h-6"></i>
            </button>
        </nav>
    </header>

    <!-- MOBILE MENU DRAWER -->
    <div id="mobile-menu" class="fixed top-0 right-0 h-full w-full max-w-xs bg-light-bg/95 backdrop-blur-lg z-[100] p-6 shadow-2xl flex flex-col items-start" role="dialog" aria-modal="true">
        <!-- Close Button -->
        <button id="menu-closer" class="self-end p-2 text-dark-text mb-8" aria-label="Close Menu">
            <i data-lucide="x" class="w-8 h-8"></i>
        </button>

        <!-- Mobile Navigation Links -->
        <nav class="flex flex-col space-y-4 w-full text-left">
            <a href="#home" class="mobile-nav-link text-3xl font-bold text-dark-text hover:text-primary-accent transition duration-200 py-2">Home</a>
            <a href="#present" class="mobile-nav-link text-3xl font-bold text-dark-text hover:text-primary-accent transition duration-200 py-2">Present</a>
            <a href="#passerelles" class="mobile-nav-link text-3xl font-bold text-dark-text hover:text-primary-accent transition duration-200 py-2">Passerelles</a>
            <a href="#facettes" class="mobile-nav-link text-3xl font-bold text-dark-text hover:text-primary-accent transition duration-200 py-2">Facettes</a>
            <a href="#about" class="mobile-nav-link text-3xl font-bold text-dark-text hover:text-primary-accent transition duration-200 py-2">About</a>
            <a href="#contact" class="mobile-nav-link text-3xl font-bold text-primary-accent py-2" data-content="contact.cta">Contact</a>
        </nav>
        
        <!-- Mobile Single Language Toggle Button -->
        <div class="mt-12 pt-4 border-t border-secondary-text/30 w-full">
            <button id="mobileLangToggle" class="text-lg font-bold px-6 py-3 rounded-full transition duration-200 w-full bg-primary-accent text-white hover:bg-hover-dark">
                English
            </button>
        </div>
    </div>
    <!-- END MOBILE MENU DRAWER -->


    <!-- CANVAS CONTAINER --><div class="canvas-container">
        <canvas id="morphCanvas" aria-hidden="true" role="presentation"></canvas>
    </div>

    <!-- MAIN CONTENT SECTIONS --><main class="relative z-10">

        <!-- 1. INTRO / HOME SECTION -->
        <section id="home" class="snap-section text-center active">
            <div class="max-w-4xl mx-auto content-container">
                <h1 class="hero-text text-dark-text leading-tight mb-4" data-content="home.title">
                    BETTARA
                    <br>
                    
                </h1>
                <h2>
                      <!-- The data-content="home.subtitle" attribute is used for dynamic content injection via JavaScript. -->
                 <span class="text-4xl sm:text-6xl font-normal block mt-4 tracking-normal text-center text-secondary-text" data-content="home.subtitle">
                        Connecting people
                    </span>  

                </h2>
                
                <p class="text-lg md:text-3xl text-dark-text mb-12 max-w-2xl mx-auto text-center" data-content="home.description">
                    To self. To the other. To audiences.
                </p>
                <!-- CTA button updated for light theme -->
                <a href="#present" class="link-button inline-flex items-center justify-center px-8 py-3 text-lg font-medium rounded-full 
                    text-dark-text border-2 border-dark-text bg-transparent 
                    hover:bg-hover-dark hover:text-white" 
                    style="--hover-shadow-color: rgba(0, 0, 0, 0.2); 
                           --tw-ring-color: #222222;" aria-label="Discover the Ventures, scroll down to the first venture."
                           data-content="home.cta">
                    Start Exploration
                </a>
            </div>
        </section>

        <!-- 2. PRESENT, PAS PRESSE (ASymmetrical Layout) -->
        <section id="present" class="snap-section">
            <div class="content-container grid grid-cols-1 lg:grid-cols-12 gap-8 items-center">
                
                <!-- Left Column: Text Content -->
                <div class="lg:col-span-6 xl:col-span-5 text-center lg:text-left">
                    
                    <h2 class="text-5xl md:text-7xl font-extrabold leading-tight text-dark-text mb-6" data-content="present.title">
                        Present, pas presse
                    </h2>
                    <p class="text-lg md:text-xl text-dark-text mb-10" data-content="present.description">
                        The art of mindful, unhurried presence. This is where intention meets pace, allowing for true depth in every action, decision, and creative pursuit.
                    </p>
                    <a href="https://present.bettara.com" target="_blank" 
                        class="link-button inline-flex items-center justify-center px-8 py-3 text-lg font-medium rounded-full 
                               text-venture-1 border-2 border-venture-1 bg-light-bg 
                               hover:bg-venture-1 hover:text-white" 
                        style="--hover-shadow-color: rgba(172, 198, 170, 0.7); 
                               --tw-ring-color: var(--venture-1);" data-content="present.cta">
                        Deep Dive →
                    </a>
                </div>

                <!-- Right Column: Visual Placeholder -->
                <div class="lg:col-span-6 xl:col-span-7 h-80 lg:h-full flex items-center justify-center relative p-8">
                        <img src="/img/present.png" alt="Present Icon" class="lg:col-span-6 xl:col-span-7 h-80 lg:h-full border-4 border-venture-1 rounded-xl ">
                </div>
            </div>
        </section>

        <!-- 3. PASSERELLES (ASymmetrical Layout - Reversed) -->
        <section id="passerelles" class="snap-section">
            <div class="content-container grid grid-cols-1 lg:grid-cols-12 gap-8 items-center">
                
                <!-- Left Column: Visual Placeholder (Reverse on Desktop) -->
                <div class="lg:col-span-6 xl:col-span-7 h-80 lg:h-full flex items-center justify-center relative p-8 order-2 lg:order-1">
                        <img src="/img/passerelles.png" alt="Passerelles Icon" class="border-4 border-venture-2 rounded-xl ">
                </div>

                <!-- Right Column: Text Content -->
                <div class="lg:col-span-6 xl:col-span-5 text-center lg:text-left order-1 lg:order-2">
               
                    <h2 class="text-5xl md:text-7xl font-extrabold leading-tight text-dark-text mb-6" data-content="passerelles.title">
                        Passerelles
                    </h2>
                    <p class="text-lg md:text-xl text-dark-text mb-10" data-content="passerelles.description">
                        Passerelles is dedicated to forging strategic connections between Arts and Sports. We operate across three core pillars: Awareness, Service & Product, and Brokage & Partnership.
                    </p>
                    <a href="https://passerelles.bettara.com" target="_blank" 
                        class="link-button inline-flex items-center justify-center px-8 py-3 text-lg font-medium rounded-full 
                               text-venture-2 border-2 border-venture-2 bg-light-bg 
                               hover:bg-venture-2 hover:text-white" 
                        style="--hover-shadow-color: rgba(113, 160, 165, 0.7);
                               --tw-ring-color: var(--venture-2);" data-content="passerelles.cta">
                        View Projects →
                    </a>
                </div>
            </div>
        </section>

        <!-- 4. FACETTES (ASymmetrical Layout) -->
        <section id="facettes" class="snap-section">
            <div class="content-container grid grid-cols-1 lg:grid-cols-12 gap-8 items-center">
                
                <!-- Left Column: Text Content -->
                <div class="lg:col-span-6 xl:col-span-5 text-center lg:text-left">
                    
                    <h2 class="text-5xl md:text-7xl font-extrabold leading-tight text-dark-text mb-6" data-content="facettes.title">
                        Facettes
                    </h2>
                    <p class="text-lg md:text-xl text-dark-text mb-10" data-content="facettes.description">
                        A celebration of the multi-faceted professional. This venture explores the diverse skills, talents, and personality traits that contribute to a holistic and successful career.
                    </p>
                    <a href="https://facettes.bettara.com" target="_blank" 
                        class="link-button inline-flex items-center justify-center px-8 py-3 text-lg font-medium rounded-full 
                               text-venture-3 border-2 border-venture-3 bg-light-bg 
                               hover:bg-venture-3 hover:text-white" 
                        style="--hover-shadow-color: rgba(119, 98, 140, 0.7);
                               --tw-ring-color: var(--venture-3);" data-content="facettes.cta">
                        Discover Facettes →
                    </a>
                </div>

                <!-- Right Column: Visual Placeholder -->
                <div class="lg:col-span-6 xl:col-span-7 h-80 lg:h-full flex items-center justify-center relative p-8">
                        <img src="/img/facettes.png" alt="Facettes Icon" class="border-4 border-venture-3 rounded-xl ">
                </div>
            </div>
        </section>

        <!-- 5. ABOUT ME SECTION (Centred, but contained) -->
        <section id="about" class="snap-section text-center">
            <div class="max-w-4xl mx-auto content-container">
                
                <h2 class="text-5xl md:text-7xl font-extrabold leading-tight text-dark-text mb-6" data-content="about.title">
                    Vision & Mission
                </h2>
                <p class="text-lg md:text-xl text-dark-text mb-10 max-w-3xl mx-auto" data-content="about.description">
                    Driven by a passion for synthesizing seemingly disparate fields, I believe the greatest insights and innovations happen at the intersection. My work is focused on creating intentional spaces (Present, pas presse) and strategic connections (Passerelles, Facettes) to unlock holistic potential.
                </p>
                <a href="#contact" class="scroll-link text-dark-text text-base font-bold underline hover:no-underline transition duration-300" aria-label="Scroll down to the Contact section." data-content="about.cta">
                    Get in Touch ↓
                </a>
            </div>
        </section>

        <!-- 6. CONTACT SECTION -->
        <section id="contact" class="snap-section">
            <div class="max-w-lg mx-auto w-full rounded-xl bg-white/50 backdrop-blur-sm shadow-2xl content-container p-6 md:p-8">
                <p class="text-xl md:text-2xl text-venture-5 mb-4 font-bold text-center uppercase tracking-widest" data-content="contact.venture_name">Collaborate</p>
                <h2 class="text-center text-5xl md:text-6xl font-extrabold text-dark-text mb-8" data-content="contact.title">
                    Contact Us
                </h2>
                <!-- Non-functional mock-up form -->
                <form onsubmit="event.preventDefault(); document.getElementById('successMessage').classList.remove('hidden');" class="space-y-4">
                    <div class="text-center">
                        <label for="name" class="block text-sm font-medium text-dark-text mb-2" data-content="contact.name_label">Name</label>
                        <input type="text" id="name" name="name" required 
                            class="w-full p-4 rounded-lg bg-white/50 border border-secondary-text text-dark-text focus:ring-venture-5 focus:border-venture-5 transition duration-200" 
                            data-content="contact.name_placeholder" placeholder="Your Name">
                    </div>
                    <div class="text-center">
                        <label for="email" class="block text-sm font-medium text-dark-text mb-2" data-content="contact.email_label">Email</label>
                        <input type="email" id="email" name="email" required 
                            class="w-full p-4 rounded-lg bg-white/50 border border-secondary-text text-dark-text focus:ring-venture-5 focus:border-venture-5 transition duration-200" 
                            data-content="contact.email_placeholder" placeholder="you@example.com">
                    </div>
                    <div class="text-center">
                        <label for="message" class="block text-sm font-medium text-dark-text mb-2" data-content="contact.message_label">Message</label>
                        <textarea id="message" name="message" rows="3" required 
                            class="w-full p-4 rounded-lg bg-white/50 border border-secondary-text text-dark-text focus:ring-venture-5 focus:border-venture-5 transition duration-200" 
                            data-content="contact.message_placeholder" placeholder="Tell me about your idea..."></textarea>
                    </div>
                    
                    <button type="submit" aria-label="Send Message"
                        class="link-button w-full inline-flex items-center justify-center px-8 py-3 text-lg font-medium rounded-full 
                           text-venture-5 border-2 border-venture-5 bg-light-bg 
                           hover:bg-venture-5 hover:text-white" 
                        style="--hover-shadow-color: rgba(172, 198, 170, 0.7);
                               --tw-ring-color: var(--venture-5);" data-content="contact.cta">
                        Send Message
                    </button>
                </form>

                <!-- Mock Success Message -->
                <div id="successMessage" role="alert" class="hidden mt-6 p-4 bg-green-200 border border-green-400 text-green-800 rounded-lg text-center" data-content="contact.success_message">
                    Message sent successfully! I'll be in touch soon.
                </div>
            </div>
        </section>

    </main>

    <!-- JAVASCRIPT FOR MORPHING ANIMATION AND DYNAMIC CONTENT -->
    <script>
        let currentLang = 'en'; // Will be updated on initial load
        
        // --- Dynamic Content & Language Logic (UPDATED FOR SINGLE TOGGLE) ---
        
        /**
         * Fetches content from the server and injects it into the DOM based on data-content attributes.
         */
        async function fetchAndRenderContent() {
            try {
                console.log('Fetching content...');
                // Fetch content from the server (which includes the current language preference based on cookie)
                const response = await fetch('/api/content');
                const content = await response.json();
                console.log('Content fetched:', content);
                console.log('Content keys:', Object.keys(content));

                // Check if content has language keys (en, fr) or is already the content for current language
                let actualContent = content;
                
                // If the response has 'home' key directly, it's already language-specific content
                if (content.home) {
                    console.log('Content is already language-specific');
                    actualContent = content;
                    
                    // Try to detect actual language from content
                    // Check the subtitle to determine language (since we know EN says "Connecting people" and FR says something else)
                    const homeSubtitle = content.home?.subtitle || '';
                    if (homeSubtitle.includes('Connecter') || homeSubtitle.includes('Comme Clarence')) {
                        currentLang = 'fr';
                        console.log('Detected French content, setting currentLang to fr');
                    } else if (homeSubtitle.includes('Connecting')) {
                        currentLang = 'en';
                        console.log('Detected English content, setting currentLang to en');
                    }
                } else {
                    console.error('Unexpected content structure:', content);
                }

                // 1. Render all text content (USE innerHTML FOR RICH TEXT SUPPORT)
                document.querySelectorAll('[data-content]').forEach(element => {
                    const [sectionKey, contentKey] = element.getAttribute('data-content').split('.');
                    // Use optional chaining for safe access, falling back to a debug message
                    const text = actualContent[sectionKey]?.[contentKey] || `[MISSING: ${sectionKey}.${contentKey}]`;
                    
                    if (element.hasAttribute('placeholder')) {
                        // Apply to placeholder attribute for inputs/textareas
                        element.placeholder = text;
                    } else {
                        // USE innerHTML instead of innerText to support rich text formatting
                        element.innerHTML = text;
                    }
                });
                
                // 2. Update language toggle buttons (force refresh from server cookie)
                updateLanguageToggle();

            } catch (error) {
                console.error("Error fetching or rendering content. Ensure the server is running with content.json:", error);
            }
        }

        /**
         * Updates the language cookie on the server and reloads content.
         * @param {string} lang - The new language ('en' or 'fr').
         */
        async function setLanguage(lang) {
            console.log('setLanguage called with:', lang);
            try {
                // This route sets the 'lang' cookie on the server
                const response = await fetch('/set-lang', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ lang }),
                    credentials: 'same-origin' // Important: ensure cookies are sent/received
                });

                console.log('Set language response:', response.status);
                const result = await response.json();
                console.log('Set language result:', result);

                if (response.ok && result.success) {
                    // CRITICAL: Update currentLang immediately from server response
                    currentLang = result.lang;
                    console.log('Language set successfully to:', currentLang);
                    
                    // Force a small delay to ensure cookie is set
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                    // Read the new language from the cookie and update UI/content
                    await fetchAndRenderContent(); 
                    closeMenu(); 
                } else {
                    console.error("Failed to set language on server. Status:", response.status, result);
                }
            } catch (error) {
                console.error("Network error setting language:", error);
            }
        }
        
        /**
         * Updates the single language toggle button text based on current language
         */
        function updateLanguageToggle() {
            console.log('updateLanguageToggle called, currentLang:', currentLang);
            
            // Update desktop toggle button - use currentLang variable directly
            const desktopToggle = document.getElementById('langToggle');
            if (desktopToggle) {
                desktopToggle.textContent = currentLang === 'en' ? 'EN' : 'FR';
                console.log('Desktop toggle updated to:', desktopToggle.textContent);
            } else {
                console.error('Desktop toggle button not found!');
            }
            
            // Update mobile toggle button - use currentLang variable directly
            const mobileToggle = document.getElementById('mobileLangToggle');
            if (mobileToggle) {
                mobileToggle.textContent = currentLang === 'en' ? 'English' : 'Français';
                console.log('Mobile toggle updated to:', mobileToggle.textContent);
            } else {
                console.error('Mobile toggle button not found!');
            }
        }
        
        /**
         * Toggles between languages
         */
        function toggleLanguage() {
            console.log('toggleLanguage called, current lang:', currentLang);
            const newLang = currentLang === 'en' ? 'fr' : 'en';
            console.log('Toggling to:', newLang);
            setLanguage(newLang);
        }
        
        // --- Mobile Menu Logic ---
        const menuToggler = document.getElementById('menu-toggler');
        const menuCloser = document.getElementById('menu-closer');
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
        const body = document.body;

        function openMenu() {
            mobileMenu.classList.add('open');
            body.style.overflowY = 'hidden'; // Prevent scrolling the main body
        }

        function closeMenu() {
            mobileMenu.classList.remove('open');
            body.style.overflowY = 'auto'; // Re-enable scrolling
        }

        // Event listeners for menu toggle and close button
        menuToggler.addEventListener('click', openMenu);
        menuCloser.addEventListener('click', closeMenu);

        // Event listeners for mobile links to close the menu upon navigation
        mobileNavLinks.forEach(link => {
            link.addEventListener('click', closeMenu);
        });

        // --- Original Canvas/Morphing Code Below ---

        // Initialize Lucide Icons and content after DOM is ready
        window.onload = function() {
            lucide.createIcons();
            
            // Event listeners for language toggle buttons (desktop and mobile)
            const desktopToggle = document.getElementById('langToggle');
            const mobileToggle = document.getElementById('mobileLangToggle');
            
            if (desktopToggle) {
                desktopToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('Desktop toggle clicked, current lang:', currentLang);
                    toggleLanguage();
                });
            }
            
            if (mobileToggle) {
                mobileToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('Mobile toggle clicked, current lang:', currentLang);
                    toggleLanguage();
                });
            }
            
            // Start content load
            fetchAndRenderContent(); 
            initCanvas(); 
        };

        // --- Configuration ---
        const VENTURES = [
            'home', 
            'present',
            'passerelles',
            'facettes',
            'about',    
            'contact'   
        ];
        // Updated colors to match the new light theme palette
        const SECTION_COLORS = {
            'home': '#eeeeee',      
            'present': '#acc6aa',   
            'passerelles': '#71a0a5', 
            'facettes': '#77628c',  
            'about': '#77628c',     
            'contact': '#acc6aa'    
        };
        const NUM_VERTICES = 16;
        const MOUSE_INFLUENCE_FACTOR = 0.03; 
        let mouseX, mouseY; 
        let animationEnabled = true; 

        // --- Canvas Setup ---
        const canvas = document.getElementById('morphCanvas');
        const ctx = canvas.getContext('2d');
        let width, height, centerX, centerY;
        let rafId;

        function resizeCanvas() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
            centerX = width / 2;
            centerY = height / 2;

            if (mouseX === undefined || mouseY === undefined) {
                mouseX = centerX;
                mouseY = centerY;
            }
        }
        
        function handleMouseMove(event) {
            mouseX = event.clientX;
            mouseY = event.clientY;
        }

        // --- Shape Generation Functions ---
        function generateShape(sides, radius, distortionFactor = 0, phase = 0) {
            const shape = [];
            for (let i = 0; i < NUM_VERTICES; i++) {
                let angle = (i / NUM_VERTICES) * 2 * Math.PI;
                let r = radius + Math.sin(angle * (sides / 2) + phase) * distortionFactor * radius;

                shape.push({
                    x: Math.cos(angle) * r,
                    y: Math.sin(angle) * r,
                    offset: Math.random() * 0.05 + 0.95 
                });
            }
            return shape;
        }
        
        let shapeStates = {};
        function generateShapeStates() {
            const radius = Math.min(width, height) * 0.45; 
            shapeStates = {
                home: generateShape(8, radius, 0.15, 0),
                present: generateShape(6, radius * 1.05, 0.05, Math.PI / 4), 
                passerelles: generateShape(8, radius * 0.95, 0.25, Math.PI / 8),
                facettes: generateShape(4, radius * 1.1, 0.1, 0),
                about: generateShape(5, radius * 1.05, 0.08, 0),
                contact: generateShape(12, radius * 1.15, 0.02, 0)
            };
        }

        // --- Interpolation (Lerp) Functions (Used for smooth morphing)---
        function lerp(a, b, t) {
            return a + (b - a) * t;
        }
        
        function smoothStep(t) {
            return t < 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2;
        }

        function interpolateShape(shapeStart, shapeEnd, t) {
            const newShape = [];
            const smoothT = smoothStep(t);
            for (let i = 0; i < NUM_VERTICES; i++) {
                newShape.push({
                    x: lerp(shapeStart[i].x, shapeEnd[i].x, smoothT),
                    y: lerp(shapeStart[i].y, shapeEnd[i].y, smoothT),
                    offset: shapeStart[i].offset 
                });
            }
            return newShape;
        }
        
        function interpolateColor(color1, color2, t) {
            function hexToRgb(hex) {
                if (hex.length === 4) {
                    hex = '#' + hex[1] + hex[1] + hex[2] + hex[2] + hex[3] + hex[3];
                }
                const bigint = parseInt(hex.slice(1), 16);
                return [ (bigint >> 16) & 255, (bigint >> 8) & 255, bigint & 255 ];
            }
            function rgbToHex(r, g, b) {
                return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
            }

            const c1 = hexToRgb(color1);
            const c2 = hexToRgb(color2);
            
            const smoothT = smoothStep(t);

            const r = Math.round(lerp(c1[0], c2[0], smoothT));
            const g = Math.round(lerp(c1[1], c2[1], smoothT));
            const b = Math.round(lerp(c1[2], c2[2], smoothT));
            
            return rgbToHex(r, g, b);
        }

        // --- Main Drawing Function ---
        function drawShape(shape, color, x, y) {
            ctx.clearRect(0, 0, width, height);
            ctx.save();
            ctx.translate(x, y); 

            ctx.beginPath();
            
            ctx.shadowBlur = 40;
            ctx.shadowColor = color; 
            
            const time = animationEnabled ? performance.now() * 0.00005 : 0; 
            ctx.rotate(time); 

            ctx.moveTo(shape[0].x * shape[0].offset, shape[0].y * shape[0].offset);

            for (let i = 1; i < shape.length; i++) {
                const p2 = shape[i];
                const cp1 = shape[i - 1];
                const cp2 = shape[(i + 1) % shape.length];
                const x_mid = (cp1.x * cp1.offset + p2.x * p2.offset) / 2;
                const y_mid = (cp1.y * cp1.offset + p2.y * p2.offset) / 2;
                
                ctx.quadraticCurveTo(
                    cp1.x * cp1.offset, cp1.y * cp1.offset, 
                    x_mid, y_mid
                );
            }
            ctx.closePath();

            ctx.fillStyle = color + 'D0';
            ctx.fill();
            
            ctx.strokeStyle = '#222222';
            ctx.lineWidth = 1;
            ctx.stroke();

            ctx.restore();
        }

        function animate(timestamp) {
            const scrollY = window.scrollY;
            const vh = window.innerHeight;
            const sections = document.querySelectorAll('.snap-section');
            const totalSections = sections.length;

            let startShape, endShape, startColor, endColor;
            let currentT; 

            const transitionIndex = Math.floor(scrollY / vh);

            sections.forEach((section, index) => {
                const sectionStart = index * vh;
                const sectionEnd = (index + 1) * vh;
                if (scrollY >= sectionStart - vh/3 && scrollY < sectionEnd - vh/3) {
                    section.classList.add('active');
                } else {
                    section.classList.remove('active');
                }
            });

            if (transitionIndex >= 0 && transitionIndex < totalSections - 1) {
                const startId = VENTURES[transitionIndex];
                const endId = VENTURES[transitionIndex + 1];
                
                const scrollStart = transitionIndex * vh;
                currentT = (scrollY - scrollStart) / vh;
                currentT = Math.max(0, Math.min(1, currentT)); 

                startShape = shapeStates[startId];
                endShape = shapeStates[endId];
                startColor = SECTION_COLORS[startId];
                endColor = SECTION_COLORS[endId];

            } else if (transitionIndex >= totalSections - 1) {
                const lastId = VENTURES[totalSections - 1];
                currentShape = shapeStates[lastId];
                startColor = SECTION_COLORS[lastId];
                endColor = SECTION_COLORS[lastId]; 
                currentT = 1;

            } else { 
                const firstId = VENTURES[0];
                currentShape = shapeStates[firstId];
                startColor = SECTION_COLORS[firstId];
                endColor = SECTION_COLORS[firstId]; 
                currentT = 0;
            }

            if (startShape && endShape) {
                currentShape = interpolateShape(startShape, endShape, currentT);
            }
            
            const interpolatedColor = interpolateColor(startColor, endColor, currentT);
            
            const influenceX = (mouseX - centerX) * MOUSE_INFLUENCE_FACTOR;
            const influenceY = (mouseY - centerY) * MOUSE_INFLUENCE_FACTOR;

            drawShape(currentShape, interpolatedColor, centerX + influenceX, centerY + influenceY);

            if (animationEnabled) {
                rafId = requestAnimationFrame(animate);
            }
        }

        // --- Initialization and Event Listeners ---
        function initCanvas() {
            resizeCanvas();
            generateShapeStates();

            if (window.matchMedia) {
                const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
                animationEnabled = !mediaQuery.matches;
                
                mediaQuery.addEventListener('change', (e) => {
                    animationEnabled = !e.matches;
                    if (animationEnabled) {
                        animate(); 
                    } else if (rafId) {
                        cancelAnimationFrame(rafId); 
                    }
                });
            }

            window.addEventListener('resize', () => {
                resizeCanvas();
                generateShapeStates();
            });
            
            window.addEventListener('mousemove', handleMouseMove);

            if (animationEnabled) {
                animate(); 
            } else {
                drawShape(shapeStates['home'], SECTION_COLORS['home'], centerX, centerY);
            }
        }
    </script>

</body>
</html>